---
import List from '../../../components/list.astro'
import { getChannelInfo } from '../../../lib/telegram'

const { channel: channelName, id } = Astro.params

// Update SITE_URL for local context
Astro.locals.SITE_URL = `${Astro.url.origin}/${channelName}/`
// Update RSS_URL for the channel-specific RSS feed
Astro.locals.RSS_URL = `${Astro.locals.SITE_URL}rss.xml`

const channel = await getChannelInfo(Astro, { channelName, before: id })

if (!channel || !channel.title) {
  return Astro.redirect('/')
}
---

<List channel={channel} />
